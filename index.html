<!DOCTYPE html>
<html>
<head>
    <title>Перенаправление...</title>
    <script type="text/javascript">
        // Функция для извлечения параметров из URL
        function getQueryParam(param) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(param);
        }

        // Получаем chat_id
        const chatId = getQueryParam('chat_id');

        // Формируем целевой URL для Streamlit
        const streamlitUrl = 'https://smartlib-app-fcz2i2s8uzbn2ffp5wsbhm.streamlit.app';

        // Если chat_id существует, добавляем его к URL
        if (chatId) {
            const finalUrl = `${streamlitUrl}?chat_id=${chatId}`;
            // Немедленно перенаправляем пользователя. 
            // window.location.replace не оставляет страницу-прокладку в истории браузера
            window.location.replace(finalUrl);
        } else {
            // Если chat_id не найден, показываем ошибку
            document.body.innerHTML = '<h1>Ошибка: ID пользователя не найден. Пожалуйста, вернитесь в Telegram и попробуйте снова.</h1>';
        }
    </script>
    <!-- Дополнительный редирект для случаев, если JS отключен -->
    <noscript>
        <meta http-equiv="refresh" content="0;url=https://smartlib-app-fcz2i2s8uzbn2ffp5wsbhm.streamlit.app/">
    </noscript>
</head>
<body>
    <p>Пожалуйста, подождите, мы перенаправляем вас для безопасной авторизации...</p>
</body>
</html>
